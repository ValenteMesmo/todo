<html>
    <header>
        <script src="elements/x-storage.js"></script>
        <script src="elements/todo-new.js"></script>
        <script src="elements/todo-item.js"></script>
        <script>
            function onLoad(){

                const storage = document.querySelector('x-storage');
                const todoNew = document.querySelector('todo-new');

                const items = storage.load();

                todoNew.onsave = function(item){

                    items.push(item);
                    storage.save(items);

                    location.reload();
                };

                items.forEach((f, i)=>{
                    const todoItem = document.createElement('todo-item');
                    todoItem.setItem(f);
                    todoItem.update = function(item){
                        items[i] = item;
                        storage.save(items);
                        todoItem.setItem(item);
                    };

                    document.body.appendChild(todoItem);
                });
            }
        </script>
    </header>
    <body onload="onLoad()">
        <x-storage></x-storage>
        <todo-new></todo-new>
        <hr>
    </body>
</html>
